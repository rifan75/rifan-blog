{
  "title": "Using Firebase with Next.js",
  "publishedAt": "2019-07-19",
  "summary": "Learn how to use Firebase with Next.js and deploy it to Vercel.",
  "image": "https://og-image.vercel.app/Using%20**Firebase**%20with%20Next.js.png?theme=dark&md=1&fontSize=100px&images=https%3A%2F%2Fassets.vercel.com%2Fimage%2Fupload%2Ffront%2Fassets%2Fdesign%2Fnextjs-white-logo.svg&images=https%3A%2F%2Ffirebase.google.com%2Fdownloads%2Fbrand-guidelines%2FSVG%2Flogo-logomark.svg",
  "body": {
    "raw": "\r\nThis guide will show you how to use Firebase 9+ with Next.js and deploy it to Vercel.\r\n\r\n### Connecting to Firebase\r\n\r\n1. Create a project in [Firebase](https://firebase.google.com/docs/firestore/quickstart).\r\n1. In the Firebase console, open Settings > Service Accounts.\r\n1. Click Generate New Private Key, then confirm by clicking Generate Key.\r\n1. Download and open the JSON file containing your service account.\r\n1. Create a new file `.env.local` and add environment variables with those values.\r\n\r\n```bash:.env.local\r\nNEXT_PUBLIC_FIREBASE_PROJECT_ID=replace-me\r\nFIREBASE_CLIENT_EMAIL=replace-me\r\nFIREBASE_PRIVATE_KEY=replace-me\r\n```\r\n\r\nCreate `lib/firebase.js` to connect to Firebase using your credentials:\r\n\r\n```js:lib/firebase.js\r\nimport * as admin from 'firebase-admin';\r\n\r\nif (!admin.apps.length) {\r\n  admin.initializeApp({\r\n    credential: admin.credential.cert({\r\n      projectId: process.env.NEXT_PUBLIC_FIREBASE_PROJECT_ID,\r\n      clientEmail: process.env.FIREBASE_CLIENT_EMAIL,\r\n      privateKey: process.env.FIREBASE_PRIVATE_KEY.replace(/\\\\n/g, '\\n')\r\n    })\r\n  });\r\n}\r\n\r\nconst db = admin.firestore();\r\n\r\nexport { db };\r\n```\r\n\r\n### Fetching Data from Firebase\r\n\r\nWe can fetch data on the server from Firebase using an [API Route](https://nextjs.org/docs/api-routes/introduction) in Next.js. You'll need to create a new collection `users` and add a document `leerob` with a `name` string field if you're following this guide, but you can change that to whatever you want.\r\n\r\n```js:pages/api/user.js\r\nimport { db } from '../../lib/firebase';\r\n\r\nexport default async function handler(req, res) {\r\n  const user = await db.collection('users').doc('leerob').get();\r\n\r\n  if (!user.exists) {\r\n    return res.status(404).json({});\r\n  }\r\n\r\n  return res.status(404).json({ id: user.id, ...user.data() });\r\n}\r\n```\r\n\r\nLet's break this down:\r\n\r\n1. You'll make a request to `/api/users` from your frontend\r\n1. A connection to Firestore is created using your service account\r\n1. The API Route queries the `users` collection and returns the `leerob` document\r\n1. We return the data for that document in the response\r\n\r\n### Displaying Data on the Client\r\n\r\nFirst, we need to install the correct dependencies:\r\n\r\n```bash\r\n$ npm i swr next@latest react@rc react-dom@rc\r\n```\r\n\r\nFinally, let's make a request to our API Route on the client-side using [SWR](https://swr.vercel.app) and Suspense:\r\n\r\n```js:pages/index.js\r\nimport { Suspense } from 'react';\r\nimport useSWR from 'swr';\r\n\r\nconst fetcher = async (...args) => {\r\n  const res = await fetch(...args);\r\n\r\n  return res.json();\r\n};\r\n\r\nfunction Profile() {\r\n  const { data } = useSWR('/api/user', fetcher, { suspense: true });\r\n  return <div>Hello, {data.name}!</div>;\r\n}\r\n\r\nexport default function App() {\r\n  return (\r\n    <Suspense fallback={<div>Loading...</div>}>\r\n      <Profile />\r\n    </Suspense>\r\n  );\r\n}\r\n```\r\n\r\nLet's break this down:\r\n\r\n1. When you request the root route (`/`) in your application, `pages/index.js` is rendered\r\n1. React suspends the rendering of the page while fetching from `/api/user`\r\n1. The fallback state (`<div>Loading...</div>`) is rendered while the data is being fetched\r\n1. After the data is fetched, the fallback state is removed and the page is re-rendered\r\n1. The `<Profile />` component shows `Hello, Lee Robinson!`\r\n\r\n## Conclusion\r\n\r\n- [View the code](https://github.com/leerob/nextjs-vercel-firebase)\r\n- [View the demo](https://nextjs-vercel-firebase.vercel.app/)\r\n- [Deploy to Vercel](https://vercel.com/new/clone?repository-url=https%3A%2F%2Fgithub.com%2Fleerob%2Fnextjs-vercel-firebase&env=NEXT_PUBLIC_FIREBASE_PROJECT_ID,FIREBASE_CLIENT_EMAIL,FIREBASE_PRIVATE_KEY&project-name=nextjs-firebase&repo-name=nextjs-firebase)\r\n\r\nRelated articles:\r\n\r\n- [Real-Time Blog Post Views With Next.js and Firebase](/blog/real-time-post-views)\r\n- [Which Back End Should I Use As A Front-End Developer?](/blog/backend)\r\n",
    "code": "var Component=(()=>{var d=Object.create;var l=Object.defineProperty;var h=Object.getOwnPropertyDescriptor;var m=Object.getOwnPropertyNames;var u=Object.getPrototypeOf,N=Object.prototype.hasOwnProperty;var k=(a,e)=>()=>(e||a((e={exports:{}}).exports,e),e.exports),g=(a,e)=>{for(var s in e)l(a,s,{get:e[s],enumerable:!0})},o=(a,e,s,t)=>{if(e&&typeof e==\"object\"||typeof e==\"function\")for(let c of m(e))!N.call(a,c)&&c!==s&&l(a,c,{get:()=>e[c],enumerable:!(t=h(e,c))||t.enumerable});return a};var f=(a,e,s)=>(s=a!=null?d(u(a)):{},o(e||!a||!a.__esModule?l(s,\"default\",{value:a,enumerable:!0}):s,a)),y=a=>o(l({},\"__esModule\",{value:!0}),a);var i=k((j,r)=>{r.exports=_jsx_runtime});var F={};g(F,{default:()=>v,frontmatter:()=>w});var n=f(i()),w={title:\"Using Firebase with Next.js\",publishedAt:\"2019-07-19\",summary:\"Learn how to use Firebase with Next.js and deploy it to Vercel.\",image:\"https://og-image.vercel.app/Using%20**Firebase**%20with%20Next.js.png?theme=dark&md=1&fontSize=100px&images=https%3A%2F%2Fassets.vercel.com%2Fimage%2Fupload%2Ffront%2Fassets%2Fdesign%2Fnextjs-white-logo.svg&images=https%3A%2F%2Ffirebase.google.com%2Fdownloads%2Fbrand-guidelines%2FSVG%2Flogo-logomark.svg\"};function p(a){let e=Object.assign({p:\"p\",h3:\"h3\",a:\"a\",span:\"span\",ol:\"ol\",li:\"li\",code:\"code\",div:\"div\",pre:\"pre\",h2:\"h2\",ul:\"ul\"},a.components);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(e.p,{children:\"This guide will show you how to use Firebase 9+ with Next.js and deploy it to Vercel.\"}),`\n`,(0,n.jsxs)(e.h3,{id:\"connecting-to-firebase\",children:[(0,n.jsx)(e.a,{className:\"anchor\",href:\"#connecting-to-firebase\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"Connecting to Firebase\"]}),`\n`,(0,n.jsxs)(e.ol,{children:[`\n`,(0,n.jsxs)(e.li,{children:[\"Create a project in \",(0,n.jsx)(e.a,{href:\"https://firebase.google.com/docs/firestore/quickstart\",children:\"Firebase\"}),\".\"]}),`\n`,(0,n.jsx)(e.li,{children:\"In the Firebase console, open Settings > Service Accounts.\"}),`\n`,(0,n.jsx)(e.li,{children:\"Click Generate New Private Key, then confirm by clicking Generate Key.\"}),`\n`,(0,n.jsx)(e.li,{children:\"Download and open the JSON file containing your service account.\"}),`\n`,(0,n.jsxs)(e.li,{children:[\"Create a new file \",(0,n.jsx)(e.code,{children:\".env.local\"}),\" and add environment variables with those values.\"]}),`\n`]}),`\n`,(0,n.jsx)(e.div,{className:\"rehype-code-title\",children:\".env.local\"}),(0,n.jsx)(e.pre,{className:\"language-bash\",children:(0,n.jsxs)(e.code,{className:\"language-bash code-highlight\",children:[(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token assign-left variable\",children:\"NEXT_PUBLIC_FIREBASE_PROJECT_ID\"}),(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),`replace-me\\r\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token assign-left variable\",children:\"FIREBASE_CLIENT_EMAIL\"}),(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),`replace-me\\r\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token assign-left variable\",children:\"FIREBASE_PRIVATE_KEY\"}),(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),`replace-me\n`]})]})}),`\n`,(0,n.jsxs)(e.p,{children:[\"Create \",(0,n.jsx)(e.code,{children:\"lib/firebase.js\"}),\" to connect to Firebase using your credentials:\"]}),`\n`,(0,n.jsx)(e.div,{className:\"rehype-code-title\",children:\"lib/firebase.js\"}),(0,n.jsx)(e.pre,{className:\"language-js\",children:(0,n.jsxs)(e.code,{className:\"language-js code-highlight\",children:[(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword module\",children:\"import\"}),\" \",(0,n.jsxs)(e.span,{className:\"token imports\",children:[(0,n.jsx)(e.span,{className:\"token operator\",children:\"*\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword module\",children:\"as\"}),\" admin\"]}),\" \",(0,n.jsx)(e.span,{className:\"token keyword module\",children:\"from\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'firebase-admin'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\\r\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\\r\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword control-flow\",children:\"if\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token operator\",children:\"!\"}),\"admin\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token property-access\",children:\"apps\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token property-access\",children:\"length\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\\r\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  admin\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token method function property-access\",children:\"initializeApp\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\\r\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token literal-property property\",children:\"credential\"}),(0,n.jsx)(e.span,{className:\"token operator\",children:\":\"}),\" admin\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token property-access\",children:\"credential\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token method function property-access\",children:\"cert\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\\r\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token literal-property property\",children:\"projectId\"}),(0,n.jsx)(e.span,{className:\"token operator\",children:\":\"}),\" process\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token property-access\",children:\"env\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token constant\",children:\"NEXT_PUBLIC_FIREBASE_PROJECT_ID\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),`\\r\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token literal-property property\",children:\"clientEmail\"}),(0,n.jsx)(e.span,{className:\"token operator\",children:\":\"}),\" process\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token property-access\",children:\"env\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token constant\",children:\"FIREBASE_CLIENT_EMAIL\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),`\\r\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token literal-property property\",children:\"privateKey\"}),(0,n.jsx)(e.span,{className:\"token operator\",children:\":\"}),\" process\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token property-access\",children:\"env\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token constant\",children:\"FIREBASE_PRIVATE_KEY\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token method function property-access\",children:\"replace\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsxs)(e.span,{className:\"token regex\",children:[(0,n.jsx)(e.span,{className:\"token regex-delimiter\",children:\"/\"}),(0,n.jsxs)(e.span,{className:\"token regex-source language-regex\",children:[(0,n.jsx)(e.span,{className:\"token special-escape escape\",children:\"\\\\\\\\\"}),\"n\"]}),(0,n.jsx)(e.span,{className:\"token regex-delimiter\",children:\"/\"}),(0,n.jsx)(e.span,{className:\"token regex-flags\",children:\"g\"})]}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'\\\\n'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\\r\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\\r\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\\r\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\\r\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\\r\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"const\"}),\" db \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" admin\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token method function property-access\",children:\"firestore\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\\r\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\\r\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword module\",children:\"export\"}),\" \",(0,n.jsxs)(e.span,{className:\"token exports\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),\" db \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"})]}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]})]})}),`\n`,(0,n.jsxs)(e.h3,{id:\"fetching-data-from-firebase\",children:[(0,n.jsx)(e.a,{className:\"anchor\",href:\"#fetching-data-from-firebase\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"Fetching Data from Firebase\"]}),`\n`,(0,n.jsxs)(e.p,{children:[\"We can fetch data on the server from Firebase using an \",(0,n.jsx)(e.a,{href:\"https://nextjs.org/docs/api-routes/introduction\",children:\"API Route\"}),\" in Next.js. You'll need to create a new collection \",(0,n.jsx)(e.code,{children:\"users\"}),\" and add a document \",(0,n.jsx)(e.code,{children:\"leerob\"}),\" with a \",(0,n.jsx)(e.code,{children:\"name\"}),\" string field if you're following this guide, but you can change that to whatever you want.\"]}),`\n`,(0,n.jsx)(e.div,{className:\"rehype-code-title\",children:\"pages/api/user.js\"}),(0,n.jsx)(e.pre,{className:\"language-js\",children:(0,n.jsxs)(e.code,{className:\"language-js code-highlight\",children:[(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword module\",children:\"import\"}),\" \",(0,n.jsxs)(e.span,{className:\"token imports\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),\" db \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"})]}),\" \",(0,n.jsx)(e.span,{className:\"token keyword module\",children:\"from\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'../../lib/firebase'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\\r\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\\r\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword module\",children:\"export\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword module\",children:\"default\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"async\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"function\"}),\" \",(0,n.jsx)(e.span,{className:\"token function\",children:\"handler\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsxs)(e.span,{className:\"token parameter\",children:[\"req\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" res\"]}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\\r\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"const\"}),\" user \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword control-flow\",children:\"await\"}),\" db\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token method function property-access\",children:\"collection\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token string\",children:\"'users'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token method function property-access\",children:\"doc\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token string\",children:\"'leerob'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token method function property-access\",children:\"get\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\\r\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\\r\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token keyword control-flow\",children:\"if\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token operator\",children:\"!\"}),\"user\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token property-access\",children:\"exists\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\\r\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token keyword control-flow\",children:\"return\"}),\" res\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token method function property-access\",children:\"status\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"404\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token method function property-access\",children:\"json\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\\r\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\\r\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\\r\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token keyword control-flow\",children:\"return\"}),\" res\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token method function property-access\",children:\"status\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"404\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token method function property-access\",children:\"json\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),\" \",(0,n.jsx)(e.span,{className:\"token literal-property property\",children:\"id\"}),(0,n.jsx)(e.span,{className:\"token operator\",children:\":\"}),\" user\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token property-access\",children:\"id\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token spread operator\",children:\"...\"}),\"user\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token method function property-access\",children:\"data\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\\r\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]})]})}),`\n`,(0,n.jsx)(e.p,{children:\"Let's break this down:\"}),`\n`,(0,n.jsxs)(e.ol,{children:[`\n`,(0,n.jsxs)(e.li,{children:[\"You'll make a request to \",(0,n.jsx)(e.code,{children:\"/api/users\"}),\" from your frontend\"]}),`\n`,(0,n.jsx)(e.li,{children:\"A connection to Firestore is created using your service account\"}),`\n`,(0,n.jsxs)(e.li,{children:[\"The API Route queries the \",(0,n.jsx)(e.code,{children:\"users\"}),\" collection and returns the \",(0,n.jsx)(e.code,{children:\"leerob\"}),\" document\"]}),`\n`,(0,n.jsx)(e.li,{children:\"We return the data for that document in the response\"}),`\n`]}),`\n`,(0,n.jsxs)(e.h3,{id:\"displaying-data-on-the-client\",children:[(0,n.jsx)(e.a,{className:\"anchor\",href:\"#displaying-data-on-the-client\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"Displaying Data on the Client\"]}),`\n`,(0,n.jsx)(e.p,{children:\"First, we need to install the correct dependencies:\"}),`\n`,(0,n.jsx)(e.pre,{className:\"language-bash\",children:(0,n.jsx)(e.code,{className:\"language-bash code-highlight\",children:(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"$ \",(0,n.jsx)(e.span,{className:\"token function\",children:\"npm\"}),` i swr next@latest react@rc react-dom@rc\n`]})})}),`\n`,(0,n.jsxs)(e.p,{children:[\"Finally, let's make a request to our API Route on the client-side using \",(0,n.jsx)(e.a,{href:\"https://swr.vercel.app\",children:\"SWR\"}),\" and Suspense:\"]}),`\n`,(0,n.jsx)(e.div,{className:\"rehype-code-title\",children:\"pages/index.js\"}),(0,n.jsx)(e.pre,{className:\"language-js\",children:(0,n.jsxs)(e.code,{className:\"language-js code-highlight\",children:[(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword module\",children:\"import\"}),\" \",(0,n.jsxs)(e.span,{className:\"token imports\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),\" \",(0,n.jsx)(e.span,{className:\"token maybe-class-name\",children:\"Suspense\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"})]}),\" \",(0,n.jsx)(e.span,{className:\"token keyword module\",children:\"from\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'react'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\\r\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword module\",children:\"import\"}),\" \",(0,n.jsx)(e.span,{className:\"token imports\",children:\"useSWR\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword module\",children:\"from\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'swr'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\\r\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\\r\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"const\"}),\" \",(0,n.jsx)(e.span,{className:\"token function-variable function\",children:\"fetcher\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"async\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsxs)(e.span,{className:\"token parameter\",children:[(0,n.jsx)(e.span,{className:\"token spread operator\",children:\"...\"}),\"args\"]}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token arrow operator\",children:\"=>\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\\r\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"const\"}),\" res \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword control-flow\",children:\"await\"}),\" \",(0,n.jsx)(e.span,{className:\"token function\",children:\"fetch\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token spread operator\",children:\"...\"}),\"args\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\\r\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\\r\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token keyword control-flow\",children:\"return\"}),\" res\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token method function property-access\",children:\"json\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\\r\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\\r\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\\r\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"function\"}),\" \",(0,n.jsx)(e.span,{className:\"token function\",children:(0,n.jsx)(e.span,{className:\"token maybe-class-name\",children:\"Profile\"})}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\\r\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"const\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),\" data \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token function\",children:\"useSWR\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token string\",children:\"'/api/user'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" fetcher\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),\" \",(0,n.jsx)(e.span,{className:\"token literal-property property\",children:\"suspense\"}),(0,n.jsx)(e.span,{className:\"token operator\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token boolean\",children:\"true\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\\r\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token keyword control-flow\",children:\"return\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"<\"}),\"div\",(0,n.jsx)(e.span,{className:\"token operator\",children:\">\"}),(0,n.jsx)(e.span,{className:\"token maybe-class-name\",children:\"Hello\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),\"data\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token property-access\",children:\"name\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),(0,n.jsx)(e.span,{className:\"token operator\",children:\"!\"}),(0,n.jsx)(e.span,{className:\"token operator\",children:\"<\"}),(0,n.jsx)(e.span,{className:\"token operator\",children:\"/\"}),\"div\",(0,n.jsx)(e.span,{className:\"token operator\",children:\">\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\\r\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\\r\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\\r\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword module\",children:\"export\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword module\",children:\"default\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"function\"}),\" \",(0,n.jsx)(e.span,{className:\"token function\",children:(0,n.jsx)(e.span,{className:\"token maybe-class-name\",children:\"App\"})}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\\r\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token keyword control-flow\",children:\"return\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),`\\r\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"<\"}),(0,n.jsx)(e.span,{className:\"token maybe-class-name\",children:\"Suspense\"}),\" fallback\",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),(0,n.jsx)(e.span,{className:\"token operator\",children:\"<\"}),\"div\",(0,n.jsx)(e.span,{className:\"token operator\",children:\">\"}),(0,n.jsx)(e.span,{className:\"token maybe-class-name\",children:\"Loading\"}),(0,n.jsx)(e.span,{className:\"token spread operator\",children:\"...\"}),(0,n.jsx)(e.span,{className:\"token operator\",children:\"<\"}),(0,n.jsx)(e.span,{className:\"token operator\",children:\"/\"}),\"div\",(0,n.jsx)(e.span,{className:\"token operator\",children:\">\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),(0,n.jsx)(e.span,{className:\"token operator\",children:\">\"}),`\\r\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"<\"}),(0,n.jsx)(e.span,{className:\"token maybe-class-name\",children:\"Profile\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"/\"}),(0,n.jsx)(e.span,{className:\"token operator\",children:\">\"}),`\\r\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"<\"}),(0,n.jsx)(e.span,{className:\"token operator\",children:\"/\"}),(0,n.jsx)(e.span,{className:\"token maybe-class-name\",children:\"Suspense\"}),(0,n.jsx)(e.span,{className:\"token operator\",children:\">\"}),`\\r\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\\r\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]})]})}),`\n`,(0,n.jsx)(e.p,{children:\"Let's break this down:\"}),`\n`,(0,n.jsxs)(e.ol,{children:[`\n`,(0,n.jsxs)(e.li,{children:[\"When you request the root route (\",(0,n.jsx)(e.code,{children:\"/\"}),\") in your application, \",(0,n.jsx)(e.code,{children:\"pages/index.js\"}),\" is rendered\"]}),`\n`,(0,n.jsxs)(e.li,{children:[\"React suspends the rendering of the page while fetching from \",(0,n.jsx)(e.code,{children:\"/api/user\"})]}),`\n`,(0,n.jsxs)(e.li,{children:[\"The fallback state (\",(0,n.jsx)(e.code,{children:\"<div>Loading...</div>\"}),\") is rendered while the data is being fetched\"]}),`\n`,(0,n.jsx)(e.li,{children:\"After the data is fetched, the fallback state is removed and the page is re-rendered\"}),`\n`,(0,n.jsxs)(e.li,{children:[\"The \",(0,n.jsx)(e.code,{children:\"<Profile />\"}),\" component shows \",(0,n.jsx)(e.code,{children:\"Hello, Lee Robinson!\"})]}),`\n`]}),`\n`,(0,n.jsxs)(e.h2,{id:\"conclusion\",children:[(0,n.jsx)(e.a,{className:\"anchor\",href:\"#conclusion\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"Conclusion\"]}),`\n`,(0,n.jsxs)(e.ul,{children:[`\n`,(0,n.jsx)(e.li,{children:(0,n.jsx)(e.a,{href:\"https://github.com/leerob/nextjs-vercel-firebase\",children:\"View the code\"})}),`\n`,(0,n.jsx)(e.li,{children:(0,n.jsx)(e.a,{href:\"https://nextjs-vercel-firebase.vercel.app/\",children:\"View the demo\"})}),`\n`,(0,n.jsx)(e.li,{children:(0,n.jsx)(e.a,{href:\"https://vercel.com/new/clone?repository-url=https%3A%2F%2Fgithub.com%2Fleerob%2Fnextjs-vercel-firebase&env=NEXT_PUBLIC_FIREBASE_PROJECT_ID,FIREBASE_CLIENT_EMAIL,FIREBASE_PRIVATE_KEY&project-name=nextjs-firebase&repo-name=nextjs-firebase\",children:\"Deploy to Vercel\"})}),`\n`]}),`\n`,(0,n.jsx)(e.p,{children:\"Related articles:\"}),`\n`,(0,n.jsxs)(e.ul,{children:[`\n`,(0,n.jsx)(e.li,{children:(0,n.jsx)(e.a,{href:\"/blog/real-time-post-views\",children:\"Real-Time Blog Post Views With Next.js and Firebase\"})}),`\n`,(0,n.jsx)(e.li,{children:(0,n.jsx)(e.a,{href:\"/blog/backend\",children:\"Which Back End Should I Use As A Front-End Developer?\"})}),`\n`]})]})}function b(a={}){let{wrapper:e}=a.components||{};return e?(0,n.jsx)(e,Object.assign({},a,{children:(0,n.jsx)(p,a)})):p(a)}var v=b;return y(F);})();\n;return Component;"
  },
  "_id": "blog/nextjs-firebase-serverless.mdx",
  "_raw": {
    "sourceFilePath": "blog/nextjs-firebase-serverless.mdx",
    "sourceFileName": "nextjs-firebase-serverless.mdx",
    "sourceFileDir": "blog",
    "contentType": "mdx",
    "flattenedPath": "blog/nextjs-firebase-serverless"
  },
  "type": "Blog",
  "readingTime": {
    "text": "3 min read",
    "minutes": 2.275,
    "time": 136500,
    "words": 455
  },
  "wordCount": 457,
  "tweetIds": [],
  "slug": "nextjs-firebase-serverless"
}